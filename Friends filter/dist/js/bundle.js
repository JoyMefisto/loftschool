"use strict";new Promise(function(e){"complite"===document.readyState?e():window.onload=e}).then(function(){return new Promise(function(e,t){VK.init({apiId:5585272}),VK.Auth.login(function(n){n.session?e(n):t(new Error("Не удалось авторизоваться!"))},2)})}).then(function(){return new Promise(function(e,t){VK.api("friends.get",{v:"5.53",fields:"photo_50"},function(n){if(n.error)t(new Error(n.error.error_msg));else{for(var r=[],a=0;a<n.response.items.length;a++)r[r.length]={first_name:n.response.items[a].first_name,last_name:n.response.items[a].last_name,photo_50:n.response.items[a].photo_50};if(r.sort(function(e,t){return e.first_name>t.first_name?1:e.first_name<t.first_name?-1:e.last_name>t.last_name?1:e.last_name<t.last_name?-1:void 0}),Handlebars.registerHelper("tolowercase",function(e){return e.toLowerCase()}),localStorage.checkFriendsObj){var i=JSON.parse(localStorage.checkFriendsObj);for(var o in r)for(var s in i)r[o].first_name==i[s].first_name&&r[o].last_name==i[s].last_name&&r[o].photo_50==i[s].photo_50&&r.splice(o,1);var l=template_checked.innerHTML,d=Handlebars.compile(l),c=d({elems:i});friends__list.innerHTML=c}var m=template_el.innerHTML,f=Handlebars.compile(m),_=f({elems:r});friends__all_list.innerHTML=_,e()}})})}).then(function(){function e(e){if("friend"==e.target.dataset.move){var r=e.target.parentNode.parentNode;"friends_next"===this.dataset.list?n.appendChild(r):"friends_back"===this.dataset.list&&t.appendChild(r)}}var t=document.querySelector("[data-list='friends_next']"),n=document.querySelector("[data-list='friends_back']"),r=document.querySelector("[data-search=friend_next]"),a=document.querySelector("[data-search=friend_back]"),i=document.getElementById("search__all_friends"),o=document.getElementById("search__list_friends");t.addEventListener("click",e),n.addEventListener("click",e),r.addEventListener("keyup",function(e){var t=this.value.toLowerCase();i.innerText="#friends__all_list li:not([data-name*="+t+"]) {display:none;}"}),a.addEventListener("keyup",function(e){var t=this.value.toLowerCase();o.innerText="#friends__list li:not([data-name*="+t+"]) {display:none;}"});var s=document.querySelector("#saveFriend"),l=[];s.addEventListener("click",function(){var e=(document.querySelector("[data-list='friends_next']").querySelectorAll("[data-move=item]"),document.querySelector("[data-list='friends_back']").querySelectorAll("[data-move=item]"));e.forEach(function(e,t){var n=e.querySelector(".info_name").innerText,r=n.split(" ");l[t]={first_name:r[0],last_name:r[1],photo_50:e.querySelector("img").getAttribute("src")}}),localStorage.checkFriendsObj=JSON.stringify(l),alert("Список друзей сохранён!")})}).catch(function(e){console.log("Ошибка: "+e.message)}),window.onload=function(){};